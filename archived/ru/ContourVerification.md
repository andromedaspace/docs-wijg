# Contour Verification

## Проблема
Необходимо не допустить существование участков с пересекающимися контурами.

## Реализация
### Контракты
#### Контракт ContourModificationManager
Создаем контракт ContourModificationManager, где у нас будет очередь из заявок двух типов
* Добавить контур
* Удалить контур

В этом контракте валидаторы контуров голосуют за заявки. Сами заявки доступны для обработки только в порядке очереди, следующая заявка из очереди будет доступна только после того, как примется решение по текущей.

#### Контракт ContourValidators

* Владелец контракта (GaltTeam/GlobalGovernance) может устанавливать размер депозита в ERC20, значение хранится в самом контракте.
* При внесении сумма депозита фиксирована и не может быть больше или меньше конкретной указанной суммы.
* При изменении требуемой суммы депозита, валидатор может довнести недостоющую сумму/вывести лишнюю.
* Адрес контракта ERC20 указывается при деплое и не может быть изменен.
* Внеся депозит указанный оператор право выполнять транзакции по верификации контуров без какого либо KYC.
* При внесении депозита указывается адрес оператора, который будет иметь право на выполнение транзакций по верифицкации. Тем самым ключи оператора, которые скорее всего будут хранитсья на сервере, не будут иметь доступ к депозиту.

### Заявка на добавление контура

* Заявитель подает заявку на аппрув контура валидаторами контуров после создания заявки в NewPropertyManager, но перед тем, как ораклы из NewPropertyManager начали работать над ней
* Аналогичный подход используется для контрактов:
  * UpdatePropertyManager (уточнение контуров через ораклов)
  * ModifyPropertyManager (обжалование контуров через арбитраторов)

Валидаторы контуров с помощью скрипта проверяют уникальность контура в рамках:
* Контуров уже заминченных токенов в SpaceGeoDataRegistry
* Контуров, привязанных к активным заявкам в NewPropertyManager
* Контуров, привязанных к активным заявкам в UpdatePropertyManager
* Контуров, привязанных к активным proposal-ам в ModifyPropertyManager

#### Особенности учета контуров в UpatePropertyManager

* Допускается пересечение текущего контура токена и контура из заявки

#### Особенности учета контуров в ModifyPropertyManager

* Для создания и голосования proposal-ам, валидация уникальности контура не требуется
* Для выполнения proposal-а и изменения контура токена, необходимо, чтобы изменяемый контур был провалидирован валидаторами контуров
* Допускается пересечение текущего контура токена и контура из proposl-а

##### Удаление данных о контуре

* Если SpaceToken был сожжен или в SpaceGeoDataRegistry ошибочно был записан контур на не существующий токен, любой адрес без авторизации может вызвать метод SpaceGeoDataRegistry по удалению информации, в т.ч. о контурах, по данному ID токена.


