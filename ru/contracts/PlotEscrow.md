# Контракт PlotEscrow  - Требования

## Описание проблемы
Необходимо обеспечить гибкую и надежную продажу токенов SPACE за Эфиры или любые другие токены ERC20 с юридическим оформлением сделки или без нее. Нужно создать ликвидный производный инструмент для крипто-инвесторов, обеспеченные земельными активами.  Сделать так, чтобы передавать токен можно было без изменений права собственности на землю в государственном реестре, но при этом права владельцев токенов были защищены.

## Цели контракта
- Надежный обмен токенов SPACE на любые токены ERC20 или эфиры.


## Статусы заявок на продажу Участков

| Статус |Описание|
|-------|---------|
|Новая||
|Открыта||
|Ожидает Escrow||
|Отменена||
|Выполнена||

## Типы операций с токенами в контракте
- Продажа токена участка без смены Кастодиана.


## Сценарий UI 1: Создание заявки на продажу Участка

1. У пользователя есть раздел `Маркетплейс`. При нажатии на кнопку он попадает в отдельный раздел с подразделами: Мои заявки на продажу, Мои заявки на покупку, Все Заявки на продажу.
2. Во всех разделах есть фильтрация по статусам заявок и количество записей, которые можно выводить.
3. При нажатии на Мои заявки на продажу он видит список своих заявок.
4. Есть кнопка `Добавить заявку на продажу`. При нажатии появляется окно с полям для ввода.

|Поле|Тип|Значение по умолчанию|Действие|
|-------|-------|---------|-----------|
|Участок|ID|Значение по умолчанию|При нажатии отображается список токенов Пользователя с картой. Он выбирает участок. Выбирается один токен|
|Продавец|Адрес|Владелец токена|Заполняется автоматически|
|Гарант прав|Адрес и Full Name|Данные из контракта PlotEscrow|Не редактируется, берется из данных контракта PlotEscrow|
|Комиссия Гаранта прав в  GALT|Float|Данные из контракта PlotEscrow|Комиссия раз в месяц, которая должна быть перечислена Гаранту прав. Берется из контракта PlotManager |
|Поле для ввода суммы оплаты / стоимости участка|Float|Пусто||
|Кнопка с выпадающим списком списка токенов|Список токенов|Пусто||
|Адрес контракта токена|Hex|Пусто|Отображается, если выбран токен, отличный от ETH|

Список токенов: список из MyEtherWallet, первым идет ETH, потом “Другой токен”, потом все остальные.

Кнопки:
- Подтвердить  - создает транзакцию с вызовом метода контракта PlotEscrow.
- Отменить - закрывает окно.

5. При нажатии кнопки подтвердить создается транзакция с вызовом метода PlotEscrow, который:  создается заявку со Статусом `Новая`.
6. Пользователь нажимает отправит заявку, создается транзакция с вызовом метода PlotEscrow. Оплачиваются комиссии, токен участка передается контракту PlotEscrow. Статус меняется на “Открыта”.

## Сценарий UI 2: Принятие заявки на продажу покупателем

1. Пользователь в Меню Все заявки на продажу видит весь список заявок.
2. Для заявки со статусом "Открыта" Пользователь видит кнопку Принять и может ее нажать.
3. Создается транзакция с вызовом метода PlotEscrow на деплой контракта Escrow и на перечисление туда токенов от Покупателя, указанных в заявке.
4. Происходит деплой нового контракта. Токены от покупателя перечислыяются на контракт Escrow. Статус заявки меняется на "Ожидает Escrow".

## Сценарий UI 3: Отправка токена участка на Escrow

1. Продавец получается уведомление об изменении статус заявки.
2. Заходит в меню заявки и видит кнопку "Отправить участок на Escrow".
