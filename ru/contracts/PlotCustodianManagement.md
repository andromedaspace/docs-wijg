# Контракт PlotCustodianManagement  - Требования

## Описание проблемы
Нужно создать ликвидный производный инструмент для крипто-инвесторов, обеспеченные земельными активами.  Сделать так, чтобы передавать токен можно было без изменений права собственности на землю в государственном реестре, но при этом права владельцев токенов были защищены. Сделать так, чтобы под землю можно было выпустить ERC20 токен.

## Цели контракта
- Возможность оценить стоимость земельного участка в токенах GALT с целью получения залога.
- Регистрация Кастодиана по земельному участку за комиссию.


## Сценарий UI 1: Создание заявки на оценку стоимости земельного участка.
0. Оценка стоимости участка необходима для того, чтобы зафиксировать стоимость для последующей продажи через DEX. Это необходимо сделать до любых регистрационных действий.
1. После того, как токен Земельного участка был создан пользователь может сделать оценку стоимости земельного участка в токенах GALT. Так как токены GALT имеют DEX и текущую стоимость, то эта оценка возможна.
2. Пользователь в меню Мои участки в меню Участка может нажать кнопку "Отправить на оценку". Появится окно для ввода следуюших параметров.

|Параметр|Значение по умолчанию|Тип|
|--------|--------|---------|
|ID Участка|Берется по выбранному участку, не редактируется|uint256|
|Селектор оплаты комиссии|GALT, меняется на ETH|Селектор|
|Поле для ввода комиссии|Минимальное значение комиссии|float|
|Рекомендуемая комиссия|Рассчитанная рекомендуемая комиссия|float|
|Поле для загрузки Описания, фотографий и документов по участку|||

3. Пользователь нажимает кнопку "Подтвердить". Создается транзакция с вызовом метода контракта PlotCustodianManagement. Метод создает заявку по оценке стоимости участка. Все загруженные файлы записываются в IPFS и записываются в заявку. Комиссия оплачивается.

## Сценарий UI 2: Выполнение оценки стоимости земельного участка
1. Оценку стоимости производят Роли: Оценщик, Контроллер - Оценщик, Аудитор.
2. В меню "Заявки на оценку" каждая из этих ролей может нажать на кнопку "Закрепить заявку".
3. Оценщик может посмотреть всю информацию по участк, включая заявку по которой тот был зарегистрирован и документы в IPFS. После этого он нажимает кнопку "Сделать оценку" и вводит стоимость участка в токенах GALT. Нажимает подтвердить, создается транзакция с методом PlotCustodianManagement и оценка записывается в заявку.
4. После того, как оценка была записана в заявку Контроллер - Оценщик должен указать ту же самую сумму или изменить ее. Если сумма была изменена, то заявка возвращается Оценщику. 
5. Если сумма совпадает, то Аудитор может подписать транзакцию. Статус заявки становится Выполнена, сумма финальной оценки вместе с таймстампом фиксируется в контракте.
6. Нужно предусмотреть дополнительные механизмы точности оценки и отсутствия мошенничества.

## Сценарий UI 3: Регистрация токена земельного участка у Кастодиана
1. Если оценка земельного участка выполнена, то возможна регистрация земельного участка у Кастодиана. Регистрация предполагает переход права собственности на участок к Кастодиану с обязательством вернуть это право держателю SPACE токена.
2. В меню земельного участка доступна кнопку "Зарегистрировать участок у Кастодиана".
3. Появляются поля для ввода данных.

|Параметр|Значение по умолчанию|Тип|
|--------|--------|---------|
|ID Участка|Берется по выбранному участку, не редактируется|uint256|
|Селектор оплаты комиссии|GALT, меняется на ETH|Селектор|
|Поле для ввода комиссии|Минимальное значение комиссии|float|
|Рекомендуемая комиссия|Рассчитанная рекомендуемая комиссия|float|
|Кастодиан|Пусто, при нажатии отображается список допустимых Кастодианов с их отображанием на карте с описанием|Адрес|

4. Пользователь нажимает "Подтвердить" и создается транзакция с вызовом метода по созданию заявки.

5. Кастодиан в меню "Мои заявки на регистрацию прав" видит все заявки, которые были назначены ему. Он нажимает кнопку "Принять заявку". Заявка меняет статус на принята. Если Кастодиан нажимает отклонить заявку, то он возвращается Пользователю и пользователь может выбрать другого Кастодиана. Кастодиан должен указать причину отклонения заявки.

6. Пользователь, если заявка принята Кастодианом нажимает кнопку - "Отправить токен на контракт Регистрации". Создается транзакция, статус заявки меняется. Создается новый контракт, на который передется токен участка. Для вывода токена участка с контракта необходимо 3 подписи: Пользователя, Кастодиана и Аудитора. Оплачивается комиссия.

7. Кастодиан офчейн готовит все необходимые документы. Пользователь встречается с Кастодианом, подписывает все необходимые документы. Кастодиан выполняет регистрационные действия и после того, как они выполнены нажимает в меню заявки кнопку "Загрузить документы". Кастодиан загружает документы и подписывает транзакцию с сохранением документов в IPFS, а хеша в заявки и в контракте, на котором находится токен Участка.

8. После этого Пользователь, Кастодиан и Аудитор должны выполнить транзакцию, которая изменит статус заявки и передаст токен участка с контракта обратно пользователю. При этом Адрес Кастодиана будет зафиксирован в контракте.

## Сценарий UI 4: Отправка токена участка на DEX
1. После этого пользователь может отправить токен на DEX и получить токены GALT, которые были определены последней оценкой.
