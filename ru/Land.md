# Контракт Land - Требования

## Описание проблемы
- Разделение и объединение земель;

## Цели контракта
- У пользователя должна быть возможность объединять и разделять свои земли;

## Сценарий контракта
### Сценарий 1: Разделение земель
Пользователь А вводные:

| Адрес пользователя | Земли (Space) | Репутация |
| ---------- | --------------- | ------- |
| 0x477...b65 | sezu01 | 500 |

1. Пользователь А разделяет sezu01. 
2. Вызывается метод split контракта Land с аргументом sezu01. Split возвращает массив из 32 дочерних элементов (sezu010, sezu011, sezu012 и т.д.) основываясь на родительском ( sezu01 ).
3. Массив дочерних элементов передается в метод createSplittedSpaces контракта Controller. 
4. Controller разделяет репутацию родительского геохэша на 32 части используя метод splitReputation контракта репутации при этом начисляя 1/32 репутации на каждый переданный геохэш. 
5. Выполняется трансфер родительского геохэша от Пользователя А на адрес мультисига. 
6. В цикле проверяется, созданы ли дочерние геохэши и если нет, то происходит mint Space токена с заданным ID в виде дочернего геохэша и трансфер токена Пользователю А:

Пользователь А после выполнения сплита:

| Адрес пользователя | Земли (Space) | Репутация |
| ---------- | --------------- | ------- |
| 0x477...b65 | sezu010 | 15,625 |
| 0x477...b65 | sezu011 | 15,625 |
| 0x477...b65 | sezu012 | 15,625 |
| 0x477...b65 | sezu013 | 15,625 |
| 0x477...b65 | sezu014 | 15,625 |
| 0x477...b65 | sezu015 | 15,625 |
| 0x477...b65 | Остальные Space токены | 406,25 |

### Сценарий 2: Объединение земель
Пользователь Б вводные:

| Адрес пользователя | Земли (Space) | Репутация |
| ---------- | --------------- | ------- |
| 0x112...fc1 | sezu0b0 | 15,625 |
| 0x112...fc1 | sezu0b1 | 15,625 |
| 0x112...fc1 | sezu0b2 | 15,625 |
| 0x112...fc1 | sezu0b3 | 15,625 |
| 0x112...fc1 | sezu0b4 | 15,625 |
| 0x112...fc1 | sezu0b5 | 15,625 |
| 0x112...fc1 | Остальные Space токены | 406,25 |

1. Пользователь Б объединяет свои участки.
2. Вызывается метод whichSpacesCanMerge контракта Land, который проверяет среди участков во владении и при нахождении общего родительского геохэша у 32-х дочерних участков ( sezu0b0, sezu0b1, sezu0b2 и т.д.) во владении возвращает их общие родительские геохэши. Например, если человек владеет 64 дочерними участками с двумя общими родителями, то ему вернется список из двух родительских участков.
3. Пользователь Б выбирает участок для объединения ( sezu0b ) из тех, что есть у него во владении. 
4. Для каждого дочернего элемента, принадлежащему выбранному для объединения родителю выполняется трансфер на multisig.
5. Вызывается метод mergeReputation контракта controller передавая туда родительский геохэш и все принадлежащие ему дочерние. Репутация из дочерних участков объединяется и передается родительскому участку.
6. Выполняется трансфер родительского участка ( sezu0b ) с multisig на адрес Пользователя Б.

Пользователь Б после выполнения мержа:

| Адрес пользователя | Земли (Space) | Репутация |
| ---------- | --------------- | ------- |
| 0x112...fc1 | sezu0b | 500 |

