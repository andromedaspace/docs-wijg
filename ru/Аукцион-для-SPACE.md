# Контракт Аукцион земли - Требования

* Epic issue https://github.com/andromedaspace/WIJG/issues/363
* UI Mindmap https://mm.tt/1116945428?t=Ko5NjQKJPi

## Описание проблемы
Необходимо обеспечить скрытие ставок пользователей на лоты аукциона, чтобы избежать злоупотребления со стороны пользователей, когда они перебивают на минимальное значение каждую новую ставку.
Так-же нужно добиться чтобы ставки пользователей отражали такую цену, которые пользователи готовы потратить на участок, а не минимальное перекрытие существующей ставки.

## Цели контракта
- Создать закрытый аукцион земли на смарт контрактах
- Скрыть ставки с помощью публичной и секретной суммы ставки на лот как в ENS аукционе
- Секретная сумма ставки должна отражать сколько пользователь действительно готов потратить на данный лот

## Основные требования:
- Принимать ставки в токенах GALT
- Создавать лоты аукциона на SPACE токены
- Дать возможность устанавливать на каждый лот свою минимальную цену
- Минимальная цена лота будет определяться базовой стоимостью 100 GALT или репутацией SPACE токена
- Публичная сумма должна быть больше или равна секретной
- При создании ставки должна быть оплачена публичная сумма
- Выигрыш в аукционе должен определяться по наибольшей секретной ставке
- Если на лот была сделана единственная ставка, то продавать по минимальной цене лота
- После окончания аукциона, если пользователь выиграл аукцион - ему должна быть возвращена разница между секретной и публичной суммой ставки
- Также, в случае если были ставки от других пользователей - выигрывшему аукцион пользователю должна быть возвращена разница между его ставкой и следующей за ней ставкой в топе секретных ставок
- В случае если на лот претендует единственный пользователь - при выигрыше возвращать разницу между минимальной ценой ставки и его публичной ценой ставки
- После окончания аукциона возвращать проигравшим суммы их публичных ставок
- Победитель лота аукциона получает во владение SPACE токен

## Сценарий контракта
### Сценарий 1: Первичная продажа SPACE токена
Только-что созданный SPACE токен попадает на аукцион с минимальной ценой лота 100 GALT.
![image](https://user-images.githubusercontent.com/4842007/41902701-6114264a-7934-11e8-83f0-30d647966d43.png)

### Сценарий 2: Продажа после отказа владельцем от SPACE токена. Единственный покупатель на аукционе
1. Пользователь отказывается от SPACE токена с залоченными 500 GALT за ним
2. SPACE токен оказывается на аукционе с минимальной ценой 500 GALT
3. На данный лот ставит единственный пользователь публичную ставку 700 GALT и секретную ставку 600 GALT
4. Больше никто не ставит на данный лот
5. Спустя какое-то время аукцион заканчивается и победитель получает разницу между 700 и 500: 200 GALT
6. Также победитель получает во владение данный SPACE токен

### Сценарий 3: Продажа после отказа владельцем от SPACE токена. Ставка равна минимальной цене
1. Пользователь отказывается от SPACE токена с залоченными 400 GALT за ним
2. SPACE токен оказывается на аукционе с минимальной ценой 400 GALT
3. На данный лот ставит единственный пользователь публичную ставку 400 GALT и секретную ставку 400 GALT
4. Больше никто не ставит на данный лот
5. Так как суммы публичной ставки и минимальной цены равны - пользователь не получает разницу между ценами, так как она равна 0
6. Победитель получает во владение данный SPACE токен

## Спецификация контракта
- Наследоваться от абстрактного класса аукциона Викри: AbstractAuction, и определить в наследуемом контракте SpaceAuction специфичную логику и дополнительные хранилища данных

## Миграция с существующей структуры на новую
![image](https://user-images.githubusercontent.com/4842007/41904693-585996a2-7939-11e8-88d0-7880c3678efa.png)

#### Допущения для DEMO:
- Пользователь не видит сумму ставок соперников (ни скрытую, ни публичную)
- Скрытая сумма ставки не хешируется в коде, а просто записывается под свойством secretValue
- Пользователю не нужно вводить ключевые слова при размещении ставки
- Пользователю не нужно вводить секретную сумму и ключевые слова при окончании аукциона
